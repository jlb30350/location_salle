<!-- app/views/rooms/availability.html.erb -->

<h2>Calendrier des réservations</h2>

<div class="calendar">
  <div class="day">
    <strong>1</strong>
    <button class="btn btn-success available-day" data-date="2024-09-01">Disponible</button>
  </div>
  <div class="day">
    <strong>2</strong>
    <button class="btn btn-success available-day" data-date="2024-09-02">Disponible</button>
  </div>
</div>


<div class="day">
  <strong>1</strong>
  <button class="btn btn-success available-day" data-date="2024-09-01">Disponible</button>
</div>


<script>
document.addEventListener("turbo:load", function() {
  let startDate = null;
  let endDate = null;

  // Sélectionner tous les boutons avec la classe .available-day
  document.querySelectorAll('.available-day').forEach(function(button) {
    console.log("Button found:", button);  // Vérifiez si les boutons sont trouvés
    button.addEventListener('click', function() {
      console.log("Button clicked:", this);  // Vérifiez si les clics sont détectés
      const selectedDate = this.getAttribute('data-date');
      
      if (!startDate) {
        // Première sélection : début de la réservation
        startDate = selectedDate;
        this.classList.add('btn-primary');
        this.classList.remove('btn-success');
      } else if (!endDate) {
        // Deuxième sélection : fin de la réservation
        endDate = selectedDate;
        this.classList.add('btn-primary');
        this.classList.remove('btn-success');

        // Redirection vers la page de création de réservation
        const roomId = document.getElementById('reservation-section').getAttribute('data-room-id');
        window.location.href = `/rooms/${roomId}/bookings/new?start_date=${startDate}&end_date=${endDate}`;
      }
    });
  });
});
</script>
