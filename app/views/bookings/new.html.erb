<h1>Finalisation de la réservation</h1>

<div id="reservation-section" data-room-id="<%= @room.id %>">
  <!-- Contenu de la section de réservation -->
</div>

<!-- Affichage des erreurs -->
<% if @booking.errors.any? %>
  <div id="error_explanation">
    <h2><%= pluralize(@booking.errors.count, "erreur") %> ont empêché la création de la réservation :</h2>
    <ul>
      <% @booking.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
    </ul>
  </div>
<% end %>

<!-- Formulaire de réservation -->
<%= form_with(model: @booking, url: room_bookings_path(@room), local: true, class: "booking-form") do |form| %>
  
  <!-- Champ Prénom -->
  <div class="form-group">
    <%= form.label :first_name, "Prénom" %>
    <%= form.text_field :first_name, class: "form-control" %>
  </div>

  <!-- Champ Nom -->
  <div class="form-group">
    <%= form.label :last_name, 'Nom' %>
    <%= form.text_field :last_name, class: 'form-control' %>
  </div>

  <!-- Champ Email -->
  <div class="form-group">
    <%= form.label :email, 'Adresse Email' %>
    <%= form.email_field :email, class: 'form-control' %>
  </div>

  <!-- Champ Téléphone -->
  <div class="form-group">
    <%= form.label :phone, 'Numéro de téléphone' %>
    <%= form.telephone_field :phone, class: 'form-control' %>
  </div>

  <!-- Champ Adresse -->
  <div class="form-group">
    <%= form.label :address, 'Adresse' %>
    <%= form.text_field :address, class: 'form-control' %>
  </div>



  <!-- Boutons de finalisation -->
  <div class="form-group">
    <%= submit_tag "Payer maintenant", name: "continue", class: "btn btn-primary" %>
    <%= submit_tag "Demander un devis", name: "quote", class: "btn btn-secondary" %>
    <%= link_to 'Retour', room_path(@room), class: 'btn btn-secondary' %>
  </div>

<% end %>

<!-- Le script pour désactiver les boutons après la soumission -->
<script>
  document.querySelector('.booking-form').addEventListener('submit', function(event) {
    var submitButtons = this.querySelectorAll('input[type="submit"]');
    submitButtons.forEach(function(button) {
      button.disabled = true;
      button.value = "Traitement en cours...";
    });
  });
</script>
